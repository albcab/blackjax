
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Common Kernels &#8212; Blackjax</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Hierarchical Bayesian neural networks" href="examples/HierarchicalBNN.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/blackjax.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Blackjax</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Blackjax by example
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="examples.html">
   Examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="examples/Introduction.html">
     A quick introduction to Blackjax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="examples/LogisticRegression.html">
     Bayesian Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="examples/TemperedSMC.html">
     Use Tempered SMC to improve exploration of MCMC methods.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="examples/use_with_numpyro.html">
     Use BlackJAX with Numpyro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="examples/use_with_pymc3.html">
     Use BlackJAX with PyMC3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="examples/use_with_tfp.html">
     Use BlackJAX with TFP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="examples/HierarchicalBNN.html">
     Hierarchical Bayesian neural networks
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API Documentation
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Common Kernels
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/blackjax-devs/blackjax"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Common Kernels
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.hmc">
     HMC
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.nuts">
     NUTS
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.rmh">
     RMH
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.tempered_smc">
     Tempered SMC
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adaptation">
   Adaptation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.stan_warmup">
     Stan full warmup
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-size-adataptation">
     Step-size adataptation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-matrix-adataptation">
     Mass matrix adataptation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diagnostics">
   Diagnostics
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effective-sample-size">
     Effective sample size
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#potential-scale-reduction">
     Potential scale reduction
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Common Kernels</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Common Kernels
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.hmc">
     HMC
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.nuts">
     NUTS
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.rmh">
     RMH
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.tempered_smc">
     Tempered SMC
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adaptation">
   Adaptation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-blackjax.stan_warmup">
     Stan full warmup
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-size-adataptation">
     Step-size adataptation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-matrix-adataptation">
     Mass matrix adataptation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diagnostics">
   Diagnostics
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effective-sample-size">
     Effective sample size
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#potential-scale-reduction">
     Potential scale reduction
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="common-kernels">
<h1>Common Kernels<a class="headerlink" href="#common-kernels" title="Permalink to this headline">¶</a></h1>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-blackjax.hmc" title="blackjax.hmc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hmc</span></code></a></p></td>
<td><p>Public API for the HMC Kernel</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-blackjax.nuts" title="blackjax.nuts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nuts</span></code></a></p></td>
<td><p>Public API for the NUTS Kernel</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-blackjax.rmh" title="blackjax.rmh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rmh</span></code></a></p></td>
<td><p>Public API for Rosenbluth-Metropolis-Hastings kernels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-blackjax.tempered_smc" title="blackjax.tempered_smc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tempered_smc</span></code></a></p></td>
<td><p>Public API for the Tempered SMC Kernel</p></td>
</tr>
</tbody>
</table>
<div class="section" id="module-blackjax.hmc">
<span id="hmc"></span><h2>HMC<a class="headerlink" href="#module-blackjax.hmc" title="Permalink to this headline">¶</a></h2>
<p>Public API for the HMC Kernel</p>
<dl class="py class">
<dt class="sig sig-object py" id="blackjax.hmc.HMCInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HMCInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">momentum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptance_probability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_divergent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_integration_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/hmc.html#HMCInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.hmc.HMCInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional information on the HMC transition.</p>
<p>This additional information can be used for debugging or computing
diagnostics.</p>
<dl class="simple">
<dt>momentum:</dt><dd><p>The momentum that was sampled and used to integrate the trajectory.</p>
</dd>
<dt>acceptance_probability</dt><dd><p>The acceptance probability of the transition, linked to the energy
difference between the original and the proposed states.</p>
</dd>
<dt>is_accepted</dt><dd><p>Whether the proposed position was accepted or the original position
was returned.</p>
</dd>
<dt>is_divergent</dt><dd><p>Whether the difference in energy between the original and the new state
exceeded the divergence threshold.</p>
</dd>
<dt>energy:</dt><dd><p>Energy of the transition.</p>
</dd>
<dt>proposal</dt><dd><p>The state proposed by the proposal. Typically includes the position and
momentum.</p>
</dd>
<dt>step_size</dt><dd><p>Size of the integration step.</p>
</dd>
<dt>num_integration_steps</dt><dd><p>Number of times we run the symplectic integrator to build the trajectory</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>momentum</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.10)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.10)"><em>Mapping</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>acceptance_probability</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>is_accepted</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
<li><p><strong>is_divergent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
<li><p><strong>energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>proposal</strong> (<em>blackjax.inference.hmc.integrators.IntegratorState</em>) – </p></li>
<li><p><strong>num_integration_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.hmc.HMCInfo.acceptance_probability">
<span class="sig-name descname"><span class="pre">acceptance_probability</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></em><a class="headerlink" href="#blackjax.hmc.HMCInfo.acceptance_probability" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.hmc.HMCInfo.energy">
<span class="sig-name descname"><span class="pre">energy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></em><a class="headerlink" href="#blackjax.hmc.HMCInfo.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.hmc.HMCInfo.is_accepted">
<span class="sig-name descname"><span class="pre">is_accepted</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#blackjax.hmc.HMCInfo.is_accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.hmc.HMCInfo.is_divergent">
<span class="sig-name descname"><span class="pre">is_divergent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#blackjax.hmc.HMCInfo.is_divergent" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.hmc.HMCInfo.momentum">
<span class="sig-name descname"><span class="pre">momentum</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#blackjax.hmc.HMCInfo.momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.hmc.HMCInfo.num_integration_steps">
<span class="sig-name descname"><span class="pre">num_integration_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></em><a class="headerlink" href="#blackjax.hmc.HMCInfo.num_integration_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.hmc.HMCInfo.proposal">
<span class="sig-name descname"><span class="pre">proposal</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">blackjax.inference.hmc.integrators.IntegratorState</span></em><a class="headerlink" href="#blackjax.hmc.HMCInfo.proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="blackjax.hmc.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logprob_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_mass_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_integration_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator=&lt;function</span> <span class="pre">velocity_verlet&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergence_threshold=1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/hmc.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.hmc.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a HMC kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logprob_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – Log probability function we wish to sample from.</p></li>
<li><p><strong>parameters</strong> – A NamedTuple that contains the parameters of the kernel to be built.</p></li>
<li><p><strong>step_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>inverse_mass_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em>) – </p></li>
<li><p><strong>num_integration_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>integrator</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – </p></li>
<li><p><strong>divergence_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A kernel that takes a rng_key and a Pytree that contains the current state</em></p></li>
<li><p><em>of the chain and that returns a new state of the chain along with</em></p></li>
<li><p><em>information about the transition.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="blackjax.hmc.new_state">
<span class="sig-name descname"><span class="pre">new_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logprob_fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#blackjax.hmc.new_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a chain state from a position.</p>
<p>The HMC kernel works with states that contain the current chain position
and its associated potential energy and derivative of the potential energy.
This function computes initial states from an initial position.  While this
function is intended to work for one chain, it is possible to use
<cite>jax.vmap</cite> to compute the initial state of several chains.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The potential energy is also known as the negative joint loglikelihood of
the model, priors, and data without the normalizing constant, otherwise
known as the negative log posterior density.</p>
</div>
<p class="rubric">Example</p>
<p>Let us assume a model with two random variables. We wish to sample from
4 chains with the following initial positions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_positions</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
</pre></div>
</div>
<p>We have a <cite>logpdf</cite> function that returns the log-probability associated with
the chain at a given position:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logprob_fn</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3000</span><span class="p">)))</span>
<span class="go">-3.4</span>
</pre></div>
</div>
<p>We can compute the initial state for each of the 4 chain as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">jax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">new_state</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span><span class="n">init_positions</span><span class="p">,</span> <span class="n">logprob_fn</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.10)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.10)"><em>Mapping</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>]</em>) – The current values of the random variables whose posterior we want to
sample from. Can be anything from a list, a (named) tuple or a dict of
arrays. The arrays can either be Numpy or JAX arrays.</p></li>
<li><p><strong>potential_fn</strong> – A function that returns the value of the potential energy when called
with a position.</p></li>
<li><p><strong>logprob_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A HMC state that contains the position, the associated potential energy and gradient of the</em></p></li>
<li><p><em>potential energy.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>blackjax.inference.hmc.base.HMCState</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-blackjax.nuts">
<span id="nuts"></span><h2>NUTS<a class="headerlink" href="#module-blackjax.nuts" title="Permalink to this headline">¶</a></h2>
<p>Public API for the NUTS Kernel</p>
<dl class="py class">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NUTSInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">momentum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_divergent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_turning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory_leftmost_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory_rightmost_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_trajectory_expansions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptance_probability</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/nuts.html#NUTSInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.nuts.NUTSInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional information on the NUTS transition.</p>
<p>This additional information can be used for debugging or computing
diagnostics.</p>
<dl class="simple">
<dt>momentum:</dt><dd><p>The momentum that was sampled and used to integrate the trajectory.</p>
</dd>
<dt>is_divergent</dt><dd><p>Whether the difference in energy between the original and the new state
exceeded the divergence threshold.</p>
</dd>
<dt>is_turning</dt><dd><p>Whether the sampling returned because the trajectory started turning back on itself.</p>
</dd>
<dt>energy:</dt><dd><p>Energy of the transition.</p>
</dd>
<dt>trajectory_leftmost_state</dt><dd><p>The leftmost state of the full trajectory.</p>
</dd>
<dt>trajectory_rightmost_state</dt><dd><p>The rightmost state of the full trajectory.</p>
</dd>
<dt>num_trajectory_expansions</dt><dd><p>Number of subtrajectory samples that were taken.</p>
</dd>
<dt>integration_steps</dt><dd><p>Number of integration steps that were taken. This is also the number of states
in the full trajectory.</p>
</dd>
<dt>acceptance_probability</dt><dd><p>average acceptance probabilty across entire trajectory</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>momentum</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.10)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.10)"><em>Mapping</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>is_divergent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
<li><p><strong>is_turning</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – </p></li>
<li><p><strong>energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>trajectory_leftmost_state</strong> (<em>blackjax.inference.hmc.integrators.IntegratorState</em>) – </p></li>
<li><p><strong>trajectory_rightmost_state</strong> (<em>blackjax.inference.hmc.integrators.IntegratorState</em>) – </p></li>
<li><p><strong>num_trajectory_expansions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>integration_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>acceptance_probability</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo.acceptance_probability">
<span class="sig-name descname"><span class="pre">acceptance_probability</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></em><a class="headerlink" href="#blackjax.nuts.NUTSInfo.acceptance_probability" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo.energy">
<span class="sig-name descname"><span class="pre">energy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></em><a class="headerlink" href="#blackjax.nuts.NUTSInfo.energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo.integration_steps">
<span class="sig-name descname"><span class="pre">integration_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></em><a class="headerlink" href="#blackjax.nuts.NUTSInfo.integration_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo.is_divergent">
<span class="sig-name descname"><span class="pre">is_divergent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#blackjax.nuts.NUTSInfo.is_divergent" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo.is_turning">
<span class="sig-name descname"><span class="pre">is_turning</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></em><a class="headerlink" href="#blackjax.nuts.NUTSInfo.is_turning" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo.momentum">
<span class="sig-name descname"><span class="pre">momentum</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#blackjax.nuts.NUTSInfo.momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo.num_trajectory_expansions">
<span class="sig-name descname"><span class="pre">num_trajectory_expansions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></em><a class="headerlink" href="#blackjax.nuts.NUTSInfo.num_trajectory_expansions" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo.trajectory_leftmost_state">
<span class="sig-name descname"><span class="pre">trajectory_leftmost_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">blackjax.inference.hmc.integrators.IntegratorState</span></em><a class="headerlink" href="#blackjax.nuts.NUTSInfo.trajectory_leftmost_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.nuts.NUTSInfo.trajectory_rightmost_state">
<span class="sig-name descname"><span class="pre">trajectory_rightmost_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">blackjax.inference.hmc.integrators.IntegratorState</span></em><a class="headerlink" href="#blackjax.nuts.NUTSInfo.trajectory_rightmost_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="blackjax.nuts.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logprob_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_mass_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_doublings=10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator=&lt;function</span> <span class="pre">velocity_verlet&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divergence_threshold=1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/nuts.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.nuts.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Build an iterative NUTS kernel.</p>
<p>This algorithm is an iteration on the original NUTS algorithm <a class="reference internal" href="#hoffman2014" id="id1"><span>[Hoffman2014]</span></a> with two major differences:
- We do not use slice samplig but multinomial sampling for the proposal <a class="reference internal" href="#betancourt2017" id="id2"><span>[Betancourt2017]</span></a>;
- The trajectory expansion is not recursive but iterative <a class="reference internal" href="#phan2019" id="id3"><span>[Phan2019]</span></a>, <a class="reference internal" href="#lao2020" id="id4"><span>[Lao2020]</span></a>.</p>
<p>The implementation can seem unusual for those familiar with similar
algorithms. Indeed, we do not conceptualize the trajectory construction as
building a tree. We feel that the tree lingo, inherited from the recursive
version, is unnecessarily complicated and hides the more general concepts
on which the NUTS algorithm is built.</p>
<p>NUTS, in essence, consists in sampling a trajectory by iteratively choosing
a direction at random and integrating in this direction a number of times
that doubles at every step. From this trajectory we continuously sample a
proposal. When the trajectory turns on itself or when we have reached the
maximum trajectory length we return the current proposal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logprob_fb</strong> – Log probability function we wish to sample from.</p></li>
<li><p><strong>parameters</strong> – A NamedTuple that contains the parameters of the kernel to be built.</p></li>
<li><p><strong>logprob_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – </p></li>
<li><p><strong>step_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
<li><p><strong>inverse_mass_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em>) – </p></li>
<li><p><strong>max_num_doublings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
<li><p><strong>integrator</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – </p></li>
<li><p><strong>divergence_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a></p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="hoffman2014"><span class="brackets">Hoffman2014</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id6">2</a>)</span></dt>
<dd><p>Hoffman, Matthew D., and Andrew Gelman. “The No-U-Turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo.” J. Mach. Learn. Res. 15.1 (2014): 1593-1623.</p>
</dd>
<dt class="label" id="betancourt2017"><span class="brackets"><a class="fn-backref" href="#id2">Betancourt2017</a></span></dt>
<dd><p>Betancourt, Michael. “A conceptual introduction to Hamiltonian Monte Carlo.” arXiv preprint arXiv:1701.02434 (2017).</p>
</dd>
<dt class="label" id="phan2019"><span class="brackets"><a class="fn-backref" href="#id3">Phan2019</a></span></dt>
<dd><p>Phan, Du, Neeraj Pradhan, and Martin Jankowiak. “Composable effects for flexible and accelerated probabilistic programming in NumPyro.” arXiv preprint arXiv:1912.11554 (2019).</p>
</dd>
<dt class="label" id="lao2020"><span class="brackets"><a class="fn-backref" href="#id4">Lao2020</a></span></dt>
<dd><p>Lao, Junpeng, et al. “tfp. mcmc: Modern markov chain monte carlo tools built for modern hardware.” arXiv preprint arXiv:2002.01184 (2020).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="blackjax.nuts.new_state">
<span class="sig-name descname"><span class="pre">new_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logprob_fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#blackjax.nuts.new_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a chain state from a position.</p>
<p>The HMC kernel works with states that contain the current chain position
and its associated potential energy and derivative of the potential energy.
This function computes initial states from an initial position.  While this
function is intended to work for one chain, it is possible to use
<cite>jax.vmap</cite> to compute the initial state of several chains.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The potential energy is also known as the negative joint loglikelihood of
the model, priors, and data without the normalizing constant, otherwise
known as the negative log posterior density.</p>
</div>
<p class="rubric">Example</p>
<p>Let us assume a model with two random variables. We wish to sample from
4 chains with the following initial positions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_positions</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">300</span><span class="p">))</span>
</pre></div>
</div>
<p>We have a <cite>logpdf</cite> function that returns the log-probability associated with
the chain at a given position:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logprob_fn</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3000</span><span class="p">)))</span>
<span class="go">-3.4</span>
</pre></div>
</div>
<p>We can compute the initial state for each of the 4 chain as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">jax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">new_state</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">))(</span><span class="n">init_positions</span><span class="p">,</span> <span class="n">logprob_fn</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.10)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.10)"><em>Mapping</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>]</em>) – The current values of the random variables whose posterior we want to
sample from. Can be anything from a list, a (named) tuple or a dict of
arrays. The arrays can either be Numpy or JAX arrays.</p></li>
<li><p><strong>potential_fn</strong> – A function that returns the value of the potential energy when called
with a position.</p></li>
<li><p><strong>logprob_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A HMC state that contains the position, the associated potential energy and gradient of the</em></p></li>
<li><p><em>potential energy.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>blackjax.inference.hmc.base.HMCState</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-blackjax.rmh">
<span id="rmh"></span><h2>RMH<a class="headerlink" href="#module-blackjax.rmh" title="Permalink to this headline">¶</a></h2>
<p>Public API for Rosenbluth-Metropolis-Hastings kernels.</p>
<dl class="py function">
<dt class="sig sig-object py" id="blackjax.rmh.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logprob_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/rmh.html#kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.rmh.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Random Walk Rosenbluth-Metropolis-Hastings algorithm with normal proposals.</p>
<p>We currently only support a Gaussian proposal but the algorithm could easily
be extended to include other proposals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logprob_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – Log probability function we wish to sample from</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em>) – Covariance matrix for the gaussian proposal distribution.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="blackjax.rmh.new_state">
<span class="sig-name descname"><span class="pre">new_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logprob_fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#blackjax.rmh.new_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a chain state from a position.</p>
<dl class="simple">
<dt>position: PyTree</dt><dd><p>The initial position of the chain</p>
</dd>
<dt>logprob_fn: Callable</dt><dd><p>Log-probability density function of the distribution we wish to sample
from.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.10)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.10)"><em>Mapping</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>logprob_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>blackjax.inference.rmh.base.RMHState</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-blackjax.tempered_smc">
<span id="tempered-smc"></span><h2>Tempered SMC<a class="headerlink" href="#module-blackjax.tempered_smc" title="Permalink to this headline">¶</a></h2>
<p>Public API for the Tempered SMC Kernel</p>
<dl class="py class">
<dt class="sig sig-object py" id="blackjax.tempered_smc.TemperedSMCState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TemperedSMCState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmbda</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/tempered_smc.html#TemperedSMCState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.tempered_smc.TemperedSMCState" title="Permalink to this definition">¶</a></dt>
<dd><p>Current state for the tempered SMC algorithm.</p>
<dl class="simple">
<dt>particles: PyTree</dt><dd><p>The particles’ positions.</p>
</dd>
<dt>lmbda: float</dt><dd><p>Current value of the tempering parameter.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.10)"><em>Iterable</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.10)"><em>Mapping</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.10)"><em>Any</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em><em>]</em><em>]</em>) – </p></li>
<li><p><strong>lmbda</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.tempered_smc.TemperedSMCState.lmbda">
<span class="sig-name descname"><span class="pre">lmbda</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></em><a class="headerlink" href="#blackjax.tempered_smc.TemperedSMCState.lmbda" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="blackjax.tempered_smc.TemperedSMCState.particles">
<span class="sig-name descname"><span class="pre">particles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#blackjax.tempered_smc.TemperedSMCState.particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="blackjax.tempered_smc.adaptive_tempered_smc">
<span class="sig-name descname"><span class="pre">adaptive_tempered_smc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logprior_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikelihood_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcmc_kernel_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_mcmc_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resampling_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_ess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_solver=&lt;function</span> <span class="pre">dichotomy&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_log_ess=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcmc_iter=10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/tempered_smc.html#adaptive_tempered_smc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.tempered_smc.adaptive_tempered_smc" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a Tempered SMC step using an adaptive schedule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logprior_fn</strong> (<em>Callable</em>) – A function that computes the log-prior density.</p></li>
<li><p><strong>loglikelihood_fn</strong> (<em>Callable</em>) – A function that returns the log-likelihood density.</p></li>
<li><p><strong>mcmc_kernel_factory</strong> (<em>Callable</em>) – A callable function that creates a mcmc kernel from a log-probability
density function.</p></li>
<li><p><strong>make_mcmc_state</strong> (<em>Callable</em>) – A function that creates a new mcmc state from a position and a
log-probability density function.</p></li>
<li><p><strong>resampling_fn</strong> (<em>Callable</em>) – A random function that resamples generated particles based of weights</p></li>
<li><p><strong>target_ess</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – The target ESS for the adaptive MCMC tempering</p></li>
<li><p><strong>root_solver</strong> (<em>Callable</em><em>, </em><em>optional</em>) – A solver utility to find delta matching the target ESS. Signature is
<cite>root_solver(fun, delta_0, min_delta, max_delta)</cite>, default is a dichotomy solver</p></li>
<li><p><strong>use_log_ess</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Use ESS in log space to solve for delta, default is <cite>True</cite>.
This is usually more stable when using gradient based solvers.</p></li>
<li><p><strong>mcmc_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Number of iterations in the MCMC chain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A callable that takes a rng_key and a TemperedSMCState that contains the current state</em></p></li>
<li><p><em>of the chain and that returns a new state of the chain along with</em></p></li>
<li><p><em>information about the transition.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="blackjax.tempered_smc.tempered_smc">
<span class="sig-name descname"><span class="pre">tempered_smc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logprior_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikelihood_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcmc_kernel_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_mcmc_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resampling_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_iterations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/tempered_smc.html#tempered_smc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.tempered_smc.tempered_smc" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the base Tempered SMC kernel.</p>
<p>Tempered SMC uses tempering to sample from a distribution given by</p>
<div class="math notranslate nohighlight">
\[p(x) \propto p_0(x) \exp(-V(x)) \mathrm{d}x\]</div>
<p>where <span class="math notranslate nohighlight">\(p_0\)</span> is the prior distribution, typically easy to sample from and for which the density
is easy to compute, and <span class="math notranslate nohighlight">\(\exp(-V(x))\)</span> is an unnormalized likelihood term for which <span class="math notranslate nohighlight">\(V(x)\)</span> is easy
to compute pointwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logprior_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – A function that computes the log density of the prior distribution</p></li>
<li><p><strong>loglikelihood_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – A function that returns the probability at a given
position.</p></li>
<li><p><strong>mcmc_kernel_factory</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – A function that creates a mcmc kernel from a log-probability density function.</p></li>
<li><p><strong>make_mcmc_state</strong> (<em>Callable</em>) – A function that creates a new mcmc state from a position and a
log-probability density function.</p></li>
<li><p><strong>resampling_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – A random function that resamples generated particles based of weights</p></li>
<li><p><strong>num_mcmc_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Number of iterations in the MCMC chain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A callable that takes a rng_key and a TemperedSMCState that contains the current state</em></p></li>
<li><p><em>of the chain and that returns a new state of the chain along with</em></p></li>
<li><p><em>information about the transition.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="adaptation">
<h1>Adaptation<a class="headerlink" href="#adaptation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-blackjax.stan_warmup">
<span id="stan-full-warmup"></span><h2>Stan full warmup<a class="headerlink" href="#module-blackjax.stan_warmup" title="Permalink to this headline">¶</a></h2>
<p>Implementation of the Stan warmup for the HMC family of sampling algorithms.</p>
<dl class="py function">
<dt class="sig sig-object py" id="blackjax.stan_warmup.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_mass_matrix_diagonal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_acceptance_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.65</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/stan_warmup.html#run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.stan_warmup.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Loop for the Stan warmup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng_key</strong> – Key for the pseudo-random number generator.</p></li>
<li><p><strong>kernel_factory</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>) – A function that takes a step size, and inverse mass matrix and returns
a transition kernel.</p></li>
<li><p><strong>initial_state</strong> (<em>blackjax.inference.hmc.base.HMCState</em>) – The state from which to start the adaptation.</p></li>
<li><p><strong>num_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The number of times the kernel is run during the warmup.</p></li>
<li><p><strong>is_mass_matrix_diagonal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Indicates whether we should adapt a diagonal or full mass matrix.</p></li>
<li><p><strong>initial_step_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – The fist step size to use.</p></li>
<li><p><strong>target_acceptance_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Target acceptance rate for step size adaptation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A tuple that contains the last state, a tuple with the step size and mass matrix, and a tuple</em></p></li>
<li><p><em>that contains the whole adaptation chain.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><em>Tuple</em></a>[blackjax.inference.hmc.base.HMCState, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)">numpy.ndarray</a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)">jax._src.numpy.lax_numpy.ndarray</a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.10)"><em>NamedTuple</em></a>]</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="step-size-adataptation">
<h2>Step-size adataptation<a class="headerlink" href="#step-size-adataptation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="blackjax.adaptation.step_size.dual_averaging_adaptation">
<span class="sig-name descname"><span class="pre">dual_averaging_adaptation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.65</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/adaptation/step_size.html#dual_averaging_adaptation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.adaptation.step_size.dual_averaging_adaptation" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune the step size in order to achieve a desired target acceptance rate.</p>
<p>Let us note <span class="math notranslate nohighlight">\(\epsilon\)</span> the current step size, <span class="math notranslate nohighlight">\(\alpha_t\)</span> the
metropolis acceptance rate at time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span> the desired
aceptance rate. We define:</p>
<p>the error at time t. We would like to find a procedure that adapts the
value of <span class="math notranslate nohighlight">\(\epsilon\)</span> such that <span class="math notranslate nohighlight">\(h(x) =\mathbb{E}\left[H_t|\epsilon\right] = 0\)</span></p>
<p>Following <a class="reference internal" href="#nesterov2009" id="id5"><span>[Nesterov2009]</span></a>, the authors of <a class="reference internal" href="#hoffman2014" id="id6"><span>[Hoffman2014]</span></a> proposed the following update scheme. If
we note <span class="math notranslate nohighlight">\(x = \log \epsilon\)</span> we follow:</p>
<p><span class="math notranslate nohighlight">\(\overline{x}_{t}\)</span> is guaranteed to converge to a value such that
<span class="math notranslate nohighlight">\(h(\overline{x}_t)\)</span> converges to 0, i.e. the Metropolis acceptance
rate converges to the desired rate.</p>
<p>See reference <a class="reference internal" href="#hoffman2014a" id="id7"><span>[Hoffman2014a]</span></a> (section 3.2.1) for a detailed discussion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t0</strong> (<em>float &gt;= 0</em>) – Free parameter that stabilizes the initial iterations of the algorithm.
Large values may slow down convergence. Introduced in <a class="reference internal" href="#hoffman2014a" id="id8"><span>[Hoffman2014a]</span></a> with a default
value of 10.</p></li>
<li><p><strong>gamma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Controls the speed of convergence of the scheme. The authors of <a class="reference internal" href="#hoffman2014a" id="id9"><span>[Hoffman2014a]</span></a> recommend
a value of 0.05.</p></li>
<li><p><strong>kappa</strong> (<em>float in</em><em> ]</em><em>0.5</em><em>, </em><em>1</em><em>]</em>) – Controls the weights of past steps in the current update. The scheme will
quickly forget earlier step for a small value of <cite>kappa</cite>. Introduced
in <a class="reference internal" href="#hoffman2014a" id="id10"><span>[Hoffman2014a]</span></a>, with a recommended value of .75</p></li>
<li><p><strong>target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Target acceptance rate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>init</em> – A function that initializes the state of the dual averaging scheme.</p></li>
<li><p><em>update</em> – A function that updates the state of the dual averaging scheme.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>]</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="nesterov2009"><span class="brackets"><a class="fn-backref" href="#id5">Nesterov2009</a></span></dt>
<dd><p>Nesterov, Yurii. “Primal-dual subgradient methods for convex
problems.” Mathematical programming 120.1 (2009): 221-259.</p>
</dd>
<dt class="label" id="hoffman2014a"><span class="brackets">Hoffman2014a</span><span class="fn-backref">(<a href="#id7">1</a>,<a href="#id8">2</a>,<a href="#id9">3</a>,<a href="#id10">4</a>)</span></dt>
<dd><p>Hoffman, Matthew D., and Andrew Gelman. “The No-U-Turn sampler:
adaptively setting path lengths in Hamiltonian Monte Carlo.” Journal
of Machine Learning Research 15.1 (2014): 1593-1623.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="blackjax.adaptation.step_size.find_reasonable_step_size">
<span class="sig-name descname"><span class="pre">find_reasonable_step_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_step_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_accept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.65</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/adaptation/step_size.html#find_reasonable_step_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.adaptation.step_size.find_reasonable_step_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a reasonable initial step size during warmup.</p>
<p>While the dual averaging scheme is guaranteed to converge to a reasonable
value for the step size starting from any value, choosing a good first
value can speed up the convergence. This heuristics doubles and halves the
step size until the acceptance probability of the HMC proposal crosses the
target value <a class="reference internal" href="#hoffman2014b" id="id11"><span>[Hoffman2014b]</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng_key</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a>) – Key used by JAX’s random number generator.</p></li>
<li><p><strong>kernel_generator</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a><em>]</em>) – A function that takes a step size as an input and returns the corresponding
sampling kernel.</p></li>
<li><p><strong>reference_hmc_state</strong> – The location (HMC state) where this first step size must be found. This function
never advances the chain.</p></li>
<li><p><strong>inverse_mass_matrix</strong> – The inverse mass matrix relative to which the step size must be found.</p></li>
<li><p><strong>initial_step_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – The first step size used to start the search.</p></li>
<li><p><strong>target_accept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Once that value of the metropolis acceptance probability is reached we
estimate that we have found a “reasonable” first step size.</p></li>
<li><p><strong>reference_state</strong> (<em>blackjax.inference.hmc.base.HMCState</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A reasonable first value for the step size.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="hoffman2014b"><span class="brackets"><a class="fn-backref" href="#id11">Hoffman2014b</a></span></dt>
<dd><p>Hoffman, Matthew D., and Andrew Gelman. “The No-U-Turn sampler:
adaptively setting path lengths in Hamiltonian Monte Carlo.” Journal
of Machine Learning Research 15.1 (2014): 1593-1623.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="mass-matrix-adataptation">
<h2>Mass matrix adataptation<a class="headerlink" href="#mass-matrix-adataptation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="blackjax.adaptation.mass_matrix.mass_matrix_adaptation">
<span class="sig-name descname"><span class="pre">mass_matrix_adaptation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">is_diagonal_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/adaptation/mass_matrix.html#mass_matrix_adaptation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.adaptation.mass_matrix.mass_matrix_adaptation" title="Permalink to this definition">¶</a></dt>
<dd><p>Adapts the values in the mass matrix by computing the covariance
between parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>is_diagonal_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – When True the algorithm adapts and returns a diagonal mass matrix
(default), otherwise adaps and returns a dense mass matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>init</em> – A function that initializes the step of the mass matrix adaptation.</p></li>
<li><p><em>update</em> – A function that updates the state of the mass matrix.</p></li>
<li><p><em>final</em> – A function that computes the inverse mass matrix based on the current
state.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.10)"><em>Callable</em></a>]</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="diagnostics">
<h1>Diagnostics<a class="headerlink" href="#diagnostics" title="Permalink to this headline">¶</a></h1>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#blackjax.diagnostics.effective_sample_size" title="blackjax.diagnostics.effective_sample_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">effective_sample_size</span></code></a>(input_array[, ...])</p></td>
<td><p>Compute estimate of the effective sample size (ess).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#blackjax.diagnostics.potential_scale_reduction" title="blackjax.diagnostics.potential_scale_reduction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">potential_scale_reduction</span></code></a>(input_array[, ...])</p></td>
<td><p>Gelman and Rubin (1992)'s potential scale reduction for computing multiple MCMC chain convergence.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="effective-sample-size">
<h2>Effective sample size<a class="headerlink" href="#effective-sample-size" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="blackjax.diagnostics.effective_sample_size">
<span class="sig-name descname"><span class="pre">effective_sample_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/diagnostics.html#effective_sample_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.diagnostics.effective_sample_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute estimate of the effective sample size (ess).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_array</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em>) – An array representing multiple chains of MCMC samples. The array must
contains a chain dimension and a sample dimension.</p></li>
<li><p><strong>chain_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The axis indicating the multiple chains. Default to 0.</p></li>
<li><p><strong>sample_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The axis indicating a single chain of MCMC samples. Default to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>NDArray of the resulting statistics (ess), with the chain and sample dimensions squeezed.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The basic ess (<span class="math notranslate nohighlight">\(N_{\mathit{eff}}\)</span>) diagnostic is computed by:</p>
<div class="math notranslate nohighlight">
\[\hat{N}_{\mathit{eff}} = \frac{MN}{\hat{\tau}}\]</div>
<div class="math notranslate nohighlight">
\[\hat{\tau} = -1 + 2 \sum_{t'=0}^K \hat{P}_{t'}\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> is the number of chains, <span class="math notranslate nohighlight">\(N\)</span> the number of draws,
<span class="math notranslate nohighlight">\(\hat{\rho}_t\)</span> is the estimated _autocorrelation at lag <span class="math notranslate nohighlight">\(t\)</span>, and
<span class="math notranslate nohighlight">\(K\)</span> is the last integer for which <span class="math notranslate nohighlight">\(\hat{P}_{K} = \hat{\rho}_{2K} +
\hat{\rho}_{2K+1}\)</span> is still positive <a class="reference internal" href="#staneff" id="id12"><span>[StanEff]</span></a> <a class="reference internal" href="#gelman2013" id="id13"><span>[Gelman2013]</span></a>.</p>
<p>The current implementation is similar to Stan, which uses Geyer’s initial monotone sequence
criterion <a class="reference internal" href="#geyer1992" id="id14"><span>[Geyer1992]</span></a> <a class="reference internal" href="#geyer2011" id="id15"><span>[Geyer2011]</span></a>.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="staneff"><span class="brackets"><a class="fn-backref" href="#id12">StanEff</a></span></dt>
<dd><p><a class="reference external" href="https://mc-stan.org/docs/2_27/reference-manual/effective-sample-size-section.html">https://mc-stan.org/docs/2_27/reference-manual/effective-sample-size-section.html</a></p>
</dd>
<dt class="label" id="gelman2013"><span class="brackets"><a class="fn-backref" href="#id13">Gelman2013</a></span></dt>
<dd><p>Gelman, Andrew, J. B. Carlin, Hal S. Stern, David B. Dunson, Aki Vehtari, and Donald B. Rubin. (2013). Bayesian Data Analysis. Third Edition. Chapman; Hall/CRC.</p>
</dd>
<dt class="label" id="geyer1992"><span class="brackets"><a class="fn-backref" href="#id14">Geyer1992</a></span></dt>
<dd><p>Geyer, Charles J. (1992). “Practical Markov Chain Monte Carlo.” Statistical Science, 473–83.</p>
</dd>
<dt class="label" id="geyer2011"><span class="brackets"><a class="fn-backref" href="#id15">Geyer2011</a></span></dt>
<dd><p>Geyer, Charles J. (2011). “Introduction to Markov Chain Monte Carlo.” In Handbook of Markov Chain Monte Carlo, edited by Steve Brooks, Andrew Gelman, Galin L. Jones, and Xiao-Li Meng, 3–48. Chapman; Hall/CRC.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="potential-scale-reduction">
<h2>Potential scale reduction<a class="headerlink" href="#potential-scale-reduction" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="blackjax.diagnostics.potential_scale_reduction">
<span class="sig-name descname"><span class="pre">potential_scale_reduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/blackjax/diagnostics.html#potential_scale_reduction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#blackjax.diagnostics.potential_scale_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Gelman and Rubin (1992)’s potential scale reduction for computing multiple MCMC chain convergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_array</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><em>Union</em></a><em>[</em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.ndarray.html#jax.numpy.ndarray" title="(in JAX)"><em>jax._src.numpy.lax_numpy.ndarray</em></a><em>]</em>) – An array representing multiple chains of MCMC samples. The array must
contains a chain dimension and a sample dimension.</p></li>
<li><p><strong>chain_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The axis indicating the multiple chains. Default to 0.</p></li>
<li><p><strong>sample_axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The axis indicating a single chain of MCMC samples. Default to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>NDArray of the resulting statistics (r-hat), with the chain and sample dimensions squeezed.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The diagnostic is computed by:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\hat{R} = \frac{\hat{V}}{W}\]</div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(W\)</span> is the within-chain variance and <span class="math notranslate nohighlight">\(\hat{V}\)</span> is the posterior variance
estimate for the pooled traces. This is the potential scale reduction factor, which
converges to unity when each of the traces is a sample from the target posterior. Values
greater than one indicate that one or more chains have not yet converged <a class="reference internal" href="#stanrhat" id="id16"><span>[StanRhat]</span></a> <a class="reference internal" href="#gelman1992" id="id17"><span>[Gelman1992]</span></a>.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="stanrhat"><span class="brackets"><a class="fn-backref" href="#id16">StanRhat</a></span></dt>
<dd><p><a class="reference external" href="https://mc-stan.org/docs/2_27/reference-manual/notation-for-samples-chains-and-draws.html#potential-scale-reduction">https://mc-stan.org/docs/2_27/reference-manual/notation-for-samples-chains-and-draws.html#potential-scale-reduction</a></p>
</dd>
<dt class="label" id="gelman1992"><span class="brackets"><a class="fn-backref" href="#id17">Gelman1992</a></span></dt>
<dd><p>Gelman, Andrew, and Donald B. Rubin. (1992) “Inference from Iterative Simulation Using Multiple Sequences.” Statistical Science 7 (4): 457–72.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="examples/HierarchicalBNN.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Hierarchical Bayesian neural networks</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The Blackjax developers<br/>
    
        &copy; Copyright 2022, The Blackjax developers.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>